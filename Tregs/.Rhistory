1 - (factorial(12)/(factorial(8) * factorial(4)))/(12^8)
1 - ((factorial(12)/(factorial(8) * factorial(4)))/(12^8))
(12* 11* 9*8*7*6*6)/factorial(8)
(12* 11* 9*8*7*6*5)/factorial(8)
(12* 11* 9*8*7*6*5)/factorial(8) /12^8
1 - 1.151212e-07
(12* 11* 10*9*8*7*6*5)/factorial(8)
(12* 11* 10*9*8*7*6*5)/factorial(8) /12^8
1 - (12* 11* 10*9*8*7*6*5)/factorial(8) /12^8
(factorial(12)/(factorial(8) * factorial(4))) + (12 * factorial(11)/(factorial(6) * factorial(5))) + (12 * factorial(11)/(factorial(5) * factorial(6))) + (12 * factorial(11)/(factorial(4) * factorial(7)))
1 - (15543/12^8)
runif(1e4, 0, 99)
?runif
pot <- sample.int(1:100, size = 1e3, replace = T, prob = punif())
pot <- sample.int(1:100, size = 1e3, replace = T)
plot(pot)
pot <- runif(1e3, min = 1, max=100)
plot(pot)
pot <- int(runif(1e3, min = 1, max=100))
pot <- integer(runif(1e3, min = 1, max=100))
pot <- as.integer(runif(1e3, min = 1, max=100))
plot(pot)
plot(density(pot))
plyr::count(pot)
pot <- as.integer(runif(1e3, min = 0, max=100))
plyr::count(pot)
pbinom(0.5, 10)
pbinom(0.5, 10, prob = 0.5)
pbinom(100, 10, prob = 0.5)
rbinom(100, 10, prob = 0.5)
rbinom(100, 1, prob = 0.5)
dbinom(pot, 10, prob = 0.5)
pot <- as.integer(runif(1e2, min = 0, max=10))
pot
?pbinom
mz_suc <- sample(pot, 1e2, replace = F, prob = 0.5)
mz_suc <- sample(pot, 1e2, replace = F, prob = pbinom(1, 1e2, 0.5))
pbinom(1, 1e2, 0.5)
pbinom(1e2, 1, 0.5)
pbinom(1e2, 1e2, 0.5)
mz_suc <- sample(pot, 1e2, replace = F, prob = pbinom(1e2, 1e2, 0.5))
mz_suc <- sample(pot, 1, replace = F, prob = pbinom(1e2, 1e2, 0.5))
mz_suc <- sample(pot, 1, replace = F)
mz_suc
mz_suc <- rbinom(pot, 1, replace = F, prob = 0.3)
mz_suc <- rbinom(pot, 1, prob = 0.3)
mz_suc
mz_suc <- rbinom(pot, 1e2, prob = 0.3)
mz_suc
mz_suc <- rbinom(1, pot, prob = 0.3)
mz_suc
mz_suc <- runif(1, pot, prob = 0.3)
mz_suc <- runif(1, pot)
?runif
mz_suc <- runif(1, 0,, 99)
mz_suc <- runif(1, 0, 99)
mz_suc
mz_suc <- as.integer( runif(1, 0, 99))
mz_suc
dist_pareto <- rpareto(1000, 40)
?rpareto
install.packages("Envstats")
install.packages("EnvStats")
dist_pareto <- rpareto(1000, 40)
library(EnvStats)
dist_pareto <- rpareto(1000, 40)
plot(density(dist_pareto))
dist_pareto <- rpareto(1000, 4)
plot(density(dist_pareto))
dist_pareto <- rpareto(40, 4)
plot(density(dist_pareto))
dist_pareto
dist_pareto <- rpareto(100, 1)
plot(density(dist_pareto))
dist_logN <- rlnorm(1000, 0, 4)
plot(density(dist_logN))
dist_logN
plot((dist_logN))
dist_logN <- rlnorm(1000, 0, 1)
plot((dist_logN))
plot(density(dist_logN))
dist_logN <- rlnorm(1000, 0, 0.1)
plot(density(dist_logN))
dist_logN
x_vec <- seq(0, 100)
my_pareto <- sapply(x_vec, pareto_func, a=2, m=1)
pareto_func <- function(x, a, m){
value = ifelse(x < m, 0,
(a * m^a)/(x^(a+1)))
return(value)
}
x_vec <- seq(0, 100)
my_pareto <- sapply(x_vec, pareto_func, a=2, m=1)
plot(x_vec, my_pareto)
my_pareto <- sapply(x_vec, pareto_func, a=2, m=10)
plot(x_vec, my_pareto)
x_vec <- seq(0, 100)
my_pareto <- sapply(x_vec, pareto_func, a=2, m=1)
plot(x_vec, my_pareto)
my_pareto <- sapply(x_vec, pareto_func, a=3, m=1)
plot(x_vec, my_pareto)
my_pareto <- sapply(x_vec, pareto_func, a=1, m=1)
plot(x_vec, my_pareto)
my_pareto <- sapply(x_vec, pareto_func, a=0.1, m=1)
plot(x_vec, my_pareto)
my_pareto <- sapply(x_vec, pareto_func, a=0.4, m=1)
plot(x_vec, my_pareto)
my_pareto <- sapply(x_vec, pareto_func, a=0.04, m=1)
plot(x_vec, my_pareto)
my_pareto <- sapply(x_vec, pareto_func, a=0.004, m=1)
plot(x_vec, my_pareto)
pareto_func <- function(x, a, m){
value = ifelse(x > m, 0,
(a * m^a)/(x^(a+1)))
return(value)
}
x_vec <- seq(0, 100)
my_pareto <- sapply(x_vec, pareto_func, a=0.004, m=40)
plot(x_vec, my_pareto)
C <- matrix(c(1,0.7,0.7,1),2,2)
L <- chol(C)
L
C
C <- matrix(c(1,0.7,0.7,1),2,2)
L <- chol(C)
tau <- diag(c(1,2))
Lambda <- tau %*% t(L)
Z <- rbind(rnorm(1e4),rnorm(1e4))
X <- Lambda %*% Z
X
plot(Z)
Z
plot(Z, X)
View(Z)
plot(Z[1,], Z[2,])
plot(X[1,], X[2,])
0.3* 10^6.4 * exp(-0.0024 *10)
log(5e4/1e2)
-log(5e4/1e2)/72
log(2)/0.086
-log(5e4/1e2)/3
log(2)/2.07
5e4/2
5e4/(2^4)
-log(3125/1.4e2)/72
log(2)/0.043
?backsolve()
X <- c(4, 0.6, 0.3)
k <- ncol(X)
rooti <- backsolve(chol(Sig),diag(k))
Sig <- c(0.5, 0.5, 0.1)
B <- diag(Sig)
C <- t(B) * B
c_inv <- matlib::inv(C)
D <- matlib::inv(chol(C))
sum(diag(D))
det(D)
det(c_inv)
X <- c(4, 0.6, 0.3)
k <- ncol(X)
rooti <- backsolve(chol(Sig),diag(k))
rooti <- backsolve(chol(C),diag(k))
k <- ncol(X)
k
X <- matrix(x)
x <- c(4, 0.6, 0.3)
X <- matrix(x)
X
k <- ncol(X)
k
X <- matrix(x, nrow = 3)
k <- ncol(X)
k
X
X <- matrix(x, ncol = 3)
k <- ncol(X)
X
k
rooti <- backsolve(chol(C),diag(k))
rooti
quads <- colSums((crossprod(rooti,(t(X)-mu)))^2)
x <- c(4, 0.6, 0.3)
mu <- c(5, 1, 0.5)
X <- matrix(x, ncol = 3)
Mu <- matrix(mu, ncol = 3)
k <- ncol(X)
rooti <- backsolve(chol(C),diag(k))
quads <- colSums((crossprod(rooti,(t(X)-Mu)))^2)
crossprod(rooti,(t(X)-Mu))
t(X)-Mu
t(X)
Mu
Mu <- matrix(mu, row = 3)
mu <- c(5, 1, 0.5)
X <- matrix(x, ncol = 3)
Mu <- matrix(mu, nrow = 3)
k <- ncol(X)
rooti <- backsolve(chol(C),diag(k))
quads <- colSums((crossprod(rooti,(t(X)-Mu)))^2)
rooti
quads
(crossprod(rooti,(t(X)-Mu)))^2
t(X)-Mu
crossprod(rooti,(t(X)-Mu))
rooti
MASS::mvrnorm(10, 4, 1.2)
MASS::mvrnorm(10, c(4, 0.2), c(1.2, 0.1))
MASS::mvrnorm(2, Mu, C)
install.packages('mvtnorm')
mvtnorm::dmvnorm(X, mean = MU, sigma = C)
mvtnorm::dmvnorm(X, mean = Mu, sigma = C)
A = matrix(c(3.9335,   0.0602,   0.2974,
4.9933,   0.7411,   0.3053,
4.5462,   0.4219,   0.2157,
3.8759,   0.5880,   0.2961))
A
A = matrix(c(3.9335,   0.0602,   0.2974),
c(4.9933,   0.7411,   0.3053),
c(4.5462,   0.4219,   0.2157),
c(3.8759,   0.5880,   0.2961))
A = matrix(c(3.9335,   0.0602,   0.2974),
c(4.9933,   0.7411,   0.3053),
c(4.5462,   0.4219,   0.2157),
c(3.8759,   0.5880,   0.2961), nrow = 3, ncol = 4)
A = matrix(c(3.9335,   0.0602,   0.2974),
c(4.9933,   0.7411,   0.3053),
c(4.5462,   0.4219,   0.2157),
c(3.8759,   0.5880,   0.2961), nrow = 4, ncol = 3)
A = matrix(nrow = 4, ncol = 3)
A <- rbind(c(3.9335,   0.0602,  0.2974),
c(4.9933,   0.7411,   0.3053),
c(4.5462,   0.4219,   0.2157),
c(3.8759,   0.5880,   0.2961))
A
mvtnorm::dmvnorm(A, mean = Mu, sigma = C)
sp_numbers <- function(Time){
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.0024 * Time);
return(sp_cal)
}
timevec <- seq(40, 100, length.out=30)
timevec <- seq(40, 69)
timevec
spval <- sp_numbers(Time = )
spval <- sp_numbers(Time = timevec)
spval
spval <- log(sp_numbers(Time = timevec))
spval
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1.5)
spcal <- spval+noise
spcal
noise
spcal <- exp(spval+noise)
spcal
plot(spval ~ timevec)
plot(spcal ~ timevec)
points(spval ~timevec, linetype='l')
plot(spcal ~ timevec, log='y')
points(spval ~timevec, linetype='l')
points(spval ~timevec, linetype=2)
points(spval ~timevec, type="l")
plot(spcal ~ timevec, log='y')
points(spval ~timevec, type="l")
plot(spcal ~ timevec, log='y')
points(spval ~ timevec)
points(spval ~ timevec, col=2)
plot(spcal ~ timevec, log='y')
points(spval ~ timevec, col=2)
points(exp(spval) ~ timevec, col=2)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2)
points(exp(spval) ~ timevec, col=2, type='l')
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1)
spcal <- exp(spval+noise)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.024 * Time);
sp_numbers <- function(Time){
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.024 * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1)
spcal <- exp(spval+noise)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
sp_numbers <- function(Time){
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.04 * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1)
spcal <- exp(spval+noise)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
sp_numbers <- function(Time){
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.4 * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1)
spcal <- exp(spval+noise)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
sp_numbers <- function(Time){
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.04 * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1)
spcal <- exp(spval+noise)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
sp_numbers <- function(Time){
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.04 * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1)
spcal <- exp(spval+noise)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
sp_numbers <- function(Time){
sp_cal = 0.3 * 10^6.4 * exp(-1 * 0.04 * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval <- log(sp_numbers(Time = timevec))
noise <- rnorm(30, 0, 1)
spcal <- exp(spval+noise)
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
spcal
write.csv(spcal, 'artf_data.csv', row.names = FALSE)
setwd("~/Desktop/Work/ABM_CPP/Tregs")
plot(spcal ~ timevec, log='y')
points(exp(spval) ~ timevec, col=2, type='l')
write.csv(spcal, 'artf_data.csv', row.names = FALSE)
sp_numbers <- function(Time, psi, phi, nu){
sp_cal = psi * 10^phi * exp(-1 * nu * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.1, phi=7, nu=0.09)
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal1 ~ timevec, col=2, log='y')
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal2) ~ timevec, col=4, type='l')
points(exp(spval2) ~ timevec, col=4, type='l')
sp_numbers <- function(Time, psi, phi, nu){
sp_cal = psi * 10^phi * exp(-1 * nu * Time);
return(sp_cal)
}
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.1, phi=7, nu=0.09)
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal1 ~ timevec, col=2, log='y')
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal2) ~ timevec, col=4, type='l')
points(exp(spval2) ~ timevec, col=4, type='l')
spval2 <- log(sp_numbers(Time = timevec, psi=0.1, phi=7, nu=0.09)
spval2 <- log(sp_numbers(Time = timevec, psi=0.1, phi=7, nu=0.09))
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.1, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal1 ~ timevec, col=2, log='y')
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal2) ~ timevec, col=4, type='l')
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.5, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal1 ~ timevec, col=2, log='y')
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal2) ~ timevec, col=4, type='l')
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.5, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal1 ~ timevec, col=2, log='y', ylim(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal2) ~ timevec, col=4, type='l')
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.5, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal1 ~ timevec, col=2, log='y', ylim = c(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal2) ~ timevec, col=4, type='l')
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.5, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal1 ~ timevec, col=2, log='y', ylim = c(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal2) ~ timevec, col=4)
points(exp(spval2) ~ timevec, col=4, type='l')
spcal2
spcal1
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.5, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal2 ~ timevec, col=2, log='y', ylim = c(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal1) ~ timevec, col=4)
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.5, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal2 ~ timevec, col=4, log='y', ylim = c(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal1) ~ timevec, col=2)
points(exp(spval2) ~ timevec, col=4, type='l')
plot(spcal2 ~ timevec, col=4, log='y', ylim = c(1e3, 1e7))
#points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal1) ~ timevec, col=2)
plot(spcal2 ~ timevec, col=4, log='y', ylim = c(1e3, 1e7))
#points(exp(spval1) ~ timevec, col=2, type='l')
points(exp(spcal1) ~ timevec, col=2)
spval2
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.5, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal2 ~ timevec, col=4, log='y', ylim = c(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points((spcal1) ~ timevec, col=2)
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.2, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal2 ~ timevec, col=4, log='y', ylim = c(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points((spcal1) ~ timevec, col=2)
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.1, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal2 ~ timevec, col=4, log='y', ylim = c(1e3, 1e7))
points(exp(spval1) ~ timevec, col=2, type='l')
points((spcal1) ~ timevec, col=2)
points(exp(spval2) ~ timevec, col=4, type='l')
timevec <- seq(40, 69)
spval1 <- log(sp_numbers(Time = timevec, psi=0.3, phi=6.4, nu=0.04))
noise1 <- rnorm(30, 0, 1)
spcal1 <- exp(spval1+noise1)
spval2 <- log(sp_numbers(Time = timevec, psi=0.1, phi=7, nu=0.09))
noise2 <- rnorm(30, 0, 0.5)
spcal2 <- exp(spval2+noise2)
plot(spcal2 ~ timevec, col=4, log='y', ylim = c(1e3, 1e6))
points(exp(spval1) ~ timevec, col=2, type='l')
points((spcal1) ~ timevec, col=2)
points(exp(spval2) ~ timevec, col=4, type='l')
sp_df <- data.frame("age.days"= timevec, "df1"= spcal1, "df2" = spcal2)
write.csv(sp_df, 'artf_data.csv', row.names = FALSE)
